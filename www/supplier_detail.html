<!DOCTYPE html> 
<html> 
<head>
  <meta charset="utf-8" /> 
  <title>Health in Hand</title>
  
  <link href="css/jquery.mobile-1.0a3.min.css" rel="stylesheet" />
  <link href="css/main.css" rel="stylesheet" />
  
  <!-- Phonegap and JQM init -->
  <script type="text/javascript" charset="utf-8" src="js/phonegap-0.9.4.js"></script>
  <script type="text/javascript" charset="utf-8" src="js/jquery-1.4.4.min.js"></script>
  <script type="text/javascript" charset="utf-8" src="js/jquery.mobile-1.0a3.min.js"></script>
  
  <!-- Utilities -->
  <script type="text/javascript" charset="utf-8" src="js/utils.js"></script>
  
  <!-- API communication -->
  <script type="text/javascript" charset="utf-8" src="js/api.js"></script>
  <script type="text/javascript" charset="utf-8" src="js/keys.js"></script>
  
</head> 
<body> 

<div data-role="page" class="page" id="supplier_detail">

  <!-- Page-specific code -->
  <script type="text/javascript">
  
    Utils.show("supplier_detail", function() {
      
      var row = Utils.param("row");
      Utils.log("row: " + row);
      
      $.mobile.pageLoading();
      Api.Supplier.find(row, function(supplier) {
        $.mobile.pageLoading(true);
        
        if (supplier) {
          $(".supplier.reveal").show();
          populateSupplier(supplier);
        }
      });
      
    });
    
    function populateSupplier(supplier) {
      $(".supplier.name").html(supplier.name);
      $(".supplier.map").click(function() {
        $.mobile.changePage({
          url: "supplier_map.html",
          data: {
            address: supplier.address,
            address_2: supplier.address_2,
            zip: supplier.zip,
            zip_plus_4: supplier.zip_plus_4,
            state: supplier.state,
            name: supplier.name,
            phone: supplier.phone
          },
          type: "get"
        });
      });
    }
  </script>

  <div data-role="header">
    <h1>Supplier Details</h1>
    <a data-role="button" class="ui-btn-right map supplier reveal">Map</a>
  </div><!-- /header -->

  <div data-role="content"> 
    <div class="supplier reveal">
      <h2 class="supplier name"></h2>
    </div>
  </div><!-- /content -->
</div><!-- /page -->

</body>
</html>