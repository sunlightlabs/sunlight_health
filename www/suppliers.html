<!DOCTYPE html> 
<html> 
<head>
  <meta charset="utf-8" /> 
  <title>Health in Hand</title>
  
  <link href="css/jquery.mobile-1.0a4.css" rel="stylesheet" />
  <link href="css/theme.css" rel="stylesheet" />
  <link href="css/main.css" rel="stylesheet" />
  
  <!-- Phonegap and JQM init -->
  <script type="text/javascript" charset="utf-8" src="js/phonegap-0.9.4.js"></script>
  <script type="text/javascript" charset="utf-8" src="js/jquery-1.5.1.min.js"></script>
  <script type="text/javascript" charset="utf-8" src="js/jquery.mobile-1.0a4.js"></script>
  
  <!-- Utilities -->
  <script type="text/javascript" charset="utf-8" src="js/utils.js"></script>
  
  <!-- API communication -->
  <script type="text/javascript" charset="utf-8" src="js/api.js"></script>
  <script type="text/javascript" charset="utf-8" src="js/keys.js"></script>
  
</head> 
<body>

<div data-role="page" class="page" id="suppliers">

  <!-- Page-specific code -->
  <script type="text/javascript">
    Utils.show("suppliers", function() {
      
      $("button.search.suppliers.nearby").click(function() {
        Utils.loading();
        
        Utils.location(function (lat, lng) {
          $.mobile.changePage({
            url: "suppliers_list.html",
            data: {lat: lat, lng: lng},
            type: "get"
          });
        });
      });
      
      
      $("input.search.supplies.text").change(function() {
        var query = $(this).val().trim();
        if (!query) {
          $("ul.list.supplies").html("");
          return;
        }
        
        console.log("filter: " + query);
        
        Api.Supplier.terms(query, function(supplies) {
          populateSupplies(supplies);
        });
      }).keyup(function() { $(this).change(); });
    });
    
    function populateSupplies(supplies) {
      Utils.loadList("supplies", supplies, function(supply) {
        console.log(supply.term);
        //var url = "suppliers_list.html?" + $.param({supply: supply.term});
        var url = "#";
        return "" + 
          "<a href=\"" + url + "\">" +
            supply.term + 
          "</a>";
      }, {empty: "No supplies found.",});
    }
  </script>

  <div data-role="content">
    <div class="content-banner">
      <h1>Sunlight Health</h1>
      <p>
        Drill down a little deeper. Find out more about the facilities near you.
      </p>
    </div>

	<div data-role="controlgroup" data-type="horizontal">
	  <button class="search suppliers nearby">Nearby</button>
	  <button class="search suppliers zip">Zipcode</button>
	</div>

	<script type="text/javascript" charset="utf-8" src="js/jquery-placehold-0.3.min.js"></script>
	<input class="supplies search text" type="text" name="query" placeholder="Start typing what you're looking for..." />

	<ul data-role="listview" data-theme="e" class="list supplies">
	  <!-- supply list goes here, template specified in JavaScript above -->
	</ul>
	
  </div><!-- /content -->

	<div data-role="footer" id="stickey_footer">
		<div data-role="navbar">
			<ul>
				<li><a href="facilities.html">Facilities</a></li>
				<li><a href="suppliers.html" class="ui-btn-active">Suppliers</a></li>
				<li><a href="drugs.html">Drugs</a></li>
			</ul>
		</div><!-- /navbar -->

  </div><!-- /footer -->

</div><!-- /page -->

</body>
</html>